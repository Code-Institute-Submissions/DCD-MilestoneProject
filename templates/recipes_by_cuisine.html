{% extends 'base.html' %} {% block content %}
<div class="col s12 m12 l10 offset-l2 center-align">
    <div class="row">
        <div class="col s12" id="cuisine_pie"></div>
    </div>
    <div class="row">
        <div class="col s12 m10 offset-m1">
            <h2>{{ recipes[0].cuisine }} Recipes</h2>
            <div class="collection">
            {% for r in recipes %}
                <a href="{{ url_for('view_recipe', recipe_id=r._id) }}" class="collection-item"><span class="flow-text teal-text text-darken-3">{{ r.recipe_name.title() }}</span> by <span class="flow-text teal-text text-darken-3">{{ r.author }}</span> <span class="black-text">Created on: {{ r.time_created.strftime('%Y-%m-%d %H:%M:%S') }} UTC</span></a>
            {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block script %}
<script>
    var pie = new d3pie("cuisine_pie", {
        header: {
            title: {
                text: "Recipes by Cuisine",
                fontSize: 24
            }
        },
        data: {
            content: [
                {% for key, val in cuisine_count.items() %}
                    { label: '{{ key }}', value: {{ val }} },
                {% endfor %}
            ]
        },
        callbacks: {
            onClickSegment: function(a) {
                loc = "{{ url_for('recipes_by_cuisine', cuisine=cuisine) }}" + a.data.label
                location.href = loc
            }
        }
    });
</script>
{% endblock %}